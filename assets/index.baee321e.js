var It=Object.defineProperty,Ct=Object.defineProperties;var At=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var ue=(t,n,o)=>n in t?It(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,p=(t,n)=>{for(var o in n||(n={}))Me.call(n,o)&&ue(t,o,n[o]);if(Q)for(var o of Q(n))_e.call(n,o)&&ue(t,o,n[o]);return t},m=(t,n)=>Ct(t,At(n));var Z=(t,n)=>{var o={};for(var s in t)Me.call(t,s)&&n.indexOf(s)<0&&(o[s]=t[s]);if(t!=null&&Q)for(var s of Q(t))n.indexOf(s)<0&&_e.call(t,s)&&(o[s]=t[s]);return o};var pe=(t,n,o)=>(ue(t,typeof n!="symbol"?n+"":n,o),o);import{l as me,r as Dt,s as ge,S as Tt,a as h,j as e,b as a,f as O,M as Re,T as Le,c as Oe,P as fe,L as B,d as kt,i as Be,F as I,R as He,n as jt,e as Et,X as Ft,D as $t,A as Pt,V as Mt,g as _t,h as Rt,C as Lt,k as Ot,m as Bt,o as ze,p as Ht,q as zt,u as Gt,t as ve,v as ee,w as Ge,x as Wt,y as Jt,z as Ut,B as Kt,E as Vt,G as be,H as j,N as ye}from"./vendor.e025d30c.js";const Xt=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}};Xt();const qt="_assetsMap_o24bq_1",Yt="_mapContainer_o24bq_10";var We={assetsMap:qt,mapContainer:Yt},Qt="/asset-tracker-cloud-app-golioth/marker.svg";const Je=37.80887,Ue=50.2832,te=.7,Ke=me.exports.icon({iconUrl:Qt,iconSize:new me.exports.Point(Je*te,Ue*te),iconAnchor:new me.exports.Point(Je*te/2,Ue*te-2)}),Ve=t=>Object.entries(t).filter(([,n])=>n!==null).reduce((n,[o,s])=>m(p({},n),{[o]:typeof s=="object"&&!Array.isArray(s)?Ve(s):s}),{}),Xe=(t,n=!0)=>(t==null?[]:Object.entries(t).filter(([,o])=>o===n)).map(([o])=>o);var A;(function(t){t.GNSS="gnss",t.NeigboringCellMeasurements="ncell"})(A||(A={}));const Zt=Dt(),E={"content-type":"application/json; charset=utf-8"},F=async({id:t,secret:n})=>new Tt({}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setIssuer(t).setExpirationTime("5m").sign(new TextEncoder().encode(n));class J extends Error{constructor(n,o){super(n);pe(this,"httpStatusCode");this.name="ApiError",this.httpStatusCode=o}}const Se=t=>n=>m(p({},n),{createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt),lastReport:new Date(n.lastReport),projectId:t.id}),qe=({jwtKey:{id:t,secret:n},endpoint:o})=>{const s=o.toString().replace(/\/$/g,"");return{projects:async()=>{const r=await fetch(`${s}/projects`,{method:"GET",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`})}),{ok:i,status:c}=r;if(!i)throw new J("Failed to fetch projects!",c);const{list:l}=await r.json();return Object.values(l).map(u=>m(p({},u),{createdAt:new Date(u.createdAt),updatedAt:new Date(u.updatedAt)}))},project:r=>({devices:async()=>{const i=await fetch(`${s}/projects/${r.id}/devices`,{method:"GET",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`})}),{ok:c,status:l}=i;if(!c)throw new J("Failed to fetch devices!",l);const{list:d}=await i.json();return Object.values(d).map(Se(r))},device:i=>({get:async()=>{const c=await fetch(`${s}/projects/${r.id}/devices/${i.id}`,{method:"GET",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`})}),{ok:l,status:d}=c;if(!l)throw new J("Failed to fetch device!",d);return Se(r)((await c.json()).data)},state:{get:async()=>{var N,y,b,f,S,v;const c=await fetch(`${s}/projects/${r.id}/devices/${i.id}/data`,{method:"GET",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`})}),{ok:l,status:d}=c;if(!l)throw new J("Failed to fetch device!",d);const u=(await c.json()).data;return{desired:m(p({},u==null?void 0:u.desired),{cfg:m(p({},(N=u==null?void 0:u.desired)==null?void 0:N.cfg),{nod:Xe((b=(y=u==null?void 0:u.desired)==null?void 0:y.cfg)==null?void 0:b.nod)})}),reported:m(p({},u==null?void 0:u.reported),{cfg:m(p({},(f=u==null?void 0:u.reported)==null?void 0:f.cfg),{nod:Xe((v=(S=u==null?void 0:u.reported)==null?void 0:S.cfg)==null?void 0:v.nod)})})}},update:async c=>{var d;const l=Zt(c);((d=l.cfg)==null?void 0:d.nod)!==void 0&&(l.cfg.nod=Object.values(A).reduce((u,g)=>{var N,y,b;return m(p({},u),{[g]:(b=(y=(N=c.cfg)==null?void 0:N.nod)==null?void 0:y.includes(g))!=null?b:!1})},{})),await fetch(`${s}/projects/${r.id}/devices/${i.id}/data/desired`,{method:"PATCH",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`}),body:JSON.stringify(l)})}},history:async({path:c,limit:l,page:d,startDate:u,endDate:g})=>{const N=await fetch(`${s}/projects/${r.id}/devices/${i.id}/stream`,{method:"POST",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`}),body:JSON.stringify({start:(u!=null?u:ge(new Date,{months:1})).toISOString(),end:(g!=null?g:new Date).toISOString(),query:{fields:[{path:c.join("."),alias:"v"},{path:"time"}],filters:[{path:c.join("."),op:"<>",value:null}]},page:d!=null?d:0,perPage:l!=null?l:100})}),{ok:y,status:b}=N;if(!y)throw new J("Failed to fetch device history!",b);return(await N.json()).list.map(C=>{var D=C,{time:S}=D,v=Z(D,["time"]);return m(p({},v),{ts:new Date(S)})})},multiHistory:async({sensors:c,limit:l,page:d,startDate:u,endDate:g})=>{const N=await fetch(`${s}/projects/${r.id}/devices/${i.id}/stream`,{method:"POST",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`}),body:JSON.stringify({start:(u!=null?u:ge(new Date,{months:1})).toISOString(),end:(g!=null?g:new Date).toISOString(),query:{fields:[...c.map(f=>({path:`${f}.v`,alias:f})),{path:"time"}]},page:d!=null?d:0,perPage:l!=null?l:100})}),y={},b=(await N.json()).list;for(const f of c){const S=b.map(Ve).find(v=>v[f]!==void 0);S!==void 0&&(y[f]={v:S[f],ts:new Date(S.time)})}return y},update:async c=>{const l=await fetch(`${s}/projects/${r.id}/devices/${i.id}`,{method:"PATCH",headers:m(p({},E),{Authorization:`Bearer ${await F({id:t,secret:n})}`}),body:JSON.stringify({name:c.name})});return Se(r)((await l.json()).data)}})})}},Ye=h.exports.createContext(void 0),H=()=>h.exports.useContext(Ye),en=({children:t,jwtKey:n,endpoint:o})=>e(Ye.Provider,{value:qe({jwtKey:n,endpoint:o}),children:t}),Qe=h.exports.createContext({setProject:()=>{},projects:[],devices:[]}),U=()=>h.exports.useContext(Qe),tn=({children:t})=>{const[n,o]=h.exports.useState(),[s,r]=h.exports.useState([]),[i,c]=h.exports.useState([]),l=H();return h.exports.useEffect(()=>{l.projects().then(r).catch(d=>{console.error("[ProjectsProvider]",d)})},[l]),h.exports.useEffect(()=>{s.length>0&&n===void 0&&o(s[0])},[s,n]),h.exports.useEffect(()=>{n!==void 0&&l.project(n).devices().then(c).catch(console.error)},[l,n]),e(Qe.Provider,{value:{project:n,setProject:o,projects:s,devices:i},children:t})},Ze=()=>{const{project:t,projects:n}=U();return e("form",{className:"project-selector",children:a("select",{className:"form-select","aria-label":"Select a project",value:t==null?void 0:t.id,onChange:()=>{},"data-intro":"You can switch between the projects in your account here.",children:[e("option",{disabled:!0,children:"Select your project:"}),n.map(o=>e("option",{value:o.id,children:o.name},o.id))]})})},et=t=>(Date.now()-t.getTime())/1e3,nn=({ts:t})=>{const[n,o]=h.exports.useState(O(t,{includeSeconds:!0,addSuffix:!0})),[s,r]=h.exports.useState(et(t));return h.exports.useEffect(()=>{const i=()=>{const l=et(t);r(l),o(O(t,{includeSeconds:!0,addSuffix:!0}))};let c;return Math.abs(s)<60?c=setTimeout(i,1e3*5):c=setTimeout(i,1e3*60),()=>{clearTimeout(c)}},[s,t]),n},ne=({ts:t})=>{const n=nn({ts:t});return e("time",{dateTime:t.toISOString(),children:n})},tt=h.exports.createContext({updateDeviceSettings:async()=>Promise.reject(new Error("[useCurrentDevice] update not possible.")),updateAssetConfiguration:async()=>Promise.reject(new Error("[useCurrentDevice] updateConfig not possible.")),setDeviceId:()=>{},setUpdateInterval:()=>{}}),z=()=>h.exports.useContext(tt),on=({children:t})=>{const{project:n}=U(),[o,s]=h.exports.useState(),[r,i]=h.exports.useState(),[c,l]=h.exports.useState(),[d,u]=h.exports.useState(5e3),g=H();h.exports.useEffect(()=>{let b=!0;if((n==null?void 0:n.id)===void 0||o===void 0||r!==void 0)return;const f=g.project({id:n==null?void 0:n.id}).device({id:o});return Promise.all([f.state.get(),f.get()]).then(([S,v])=>{!b||(i(v),l(S))}).catch(console.error),()=>{b=!1}},[n,o,r,g]),h.exports.useEffect(()=>{let b=!0;if(r===void 0||d<1e3)return;const f=async()=>{r!==void 0&&g.project({id:r.projectId}).device({id:r.id}).state.get().then(v=>{!b||l(v)}).catch(console.error)};console.debug("[autoUpdateDeviceState]","enabled",d);const S=setInterval(f,d);return()=>{console.debug("[autoUpdateDeviceState]","disabled"),clearInterval(S),b=!1}},[r,g,d,l]),h.exports.useEffect(()=>{o===void 0&&(i(void 0),l(void 0))},[o]);const N=async b=>{if(r===void 0)throw new Error("[useCurrentDevice]: device not set");return g.project({id:r.projectId}).device({id:r.id}).update(b).then(f=>(i(f),f))},y=async b=>{var f;if(r===void 0){console.warn("[updateAssetConfiguration]","Asset not available.");return}if(c===void 0){console.warn("[updateAssetConfiguration]","Asset state not available.");return}l(m(p({},c),{desired:m(p({},c.desired),{cfg:p(p({},(f=c.desired)==null?void 0:f.cfg),b)})})),await g.project({id:r.projectId}).device({id:r.id}).state.update({cfg:b})};return e(tt.Provider,{value:{setDeviceId:s,updateDeviceSettings:N,updateAssetConfiguration:y,setUpdateInterval:u,device:r,state:c},children:t})};var $;(function(t){t.Battery="bat",t.Environment="env",t.GNSS="gnss",t.Roaming="roam",t.Asset="dev",t.Button="btn"})($||($={}));const K=({sensor:t,limit:n,startDate:o,endDate:s})=>{const[r,i]=h.exports.useState([]),c=H(),{device:l}=z();return h.exports.useEffect(()=>{l!==void 0&&c.project({id:l.projectId}).device({id:l.id}).history({path:[t,"v"],limit:n,startDate:o,endDate:s}).then(i).catch(console.error)},[l,c,t,n,o,s]),r},sn=()=>{const[t,n]=h.exports.useState([]),{project:o,devices:s}=U(),r=H();return h.exports.useEffect(()=>{o!==void 0&&Promise.all(s.map(async i=>r.project(o).device(i).history({path:[$.GNSS,"v"],limit:1}).then(([{v:c,ts:l}])=>({position:c,asset:i,ts:l})))).then(n).catch(console.error)},[o,s,r]),t},rn=()=>{const[t,n]=h.exports.useState(),{project:o}=U(),s=sn(),r={lat:63.421057567379194,lng:10.43714466087136},i=3;return t&&t.flyTo(r),a("main",{className:We.assetsMap,children:[e(Ze,{}),a(Re,{center:[r.lat,r.lng],zoom:i,whenCreated:n,className:We.mapContainer,children:[e(Le,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s.map(({position:c,asset:l,ts:d})=>e(Oe,{position:c,icon:Ke,children:a(fe,{children:[e(B,{to:`/project/${o==null?void 0:o.id}/asset/${l.id}`,children:l.name}),e("br",{}),e(ne,{ts:d})]})},l.id))]})]})},an="_iconContainer_ez3pr_1",cn="_iconWithText_ez3pr_6";var nt={iconContainer:an,iconWithText:cn};const ln=t=>n=>{var o,s,r,i,c,l,d;return e("span",{className:`${(o=t.className)!=null?o:""} ${nt.iconContainer} feather-icon`,style:{height:`${(s=t.size)!=null?s:20}px`,width:`${(r=t.size)!=null?r:20}px`,color:`${(i=t.color)!=null?i:"inherit"}`},"aria-label":t.title,dangerouslySetInnerHTML:{__html:n.toSvg({"stroke-width":`${(c=t.strokeWidth)!=null?c:"1.5"}px`,width:`${(l=t.size)!=null?l:20}px`,height:`${(d=t.size)!=null?d:20}px`})}})},w=o=>{var s=o,{type:t}=s,n=Z(s,["type"]);return ln(n)(kt.exports.icons[t])},dn=t=>e(w,m(p({},t),{type:"navigation",title:"speed"})),ot=t=>e(w,m(p({},t),{title:"\u2601\uFE0F",type:"cloud"})),Ne=t=>e(w,m(p({},t),{title:"\u2699\uFE0F",type:"settings"})),hn=t=>e(w,{title:"Warning",color:"#b00000",strokeWidth:2,type:"alert-triangle"}),un=t=>e(w,m(p({},t),{title:"altitude",type:"arrow-up"})),st=t=>e(w,m(p({},t),{color:"#b00000",title:"X",type:"x"})),pn=t=>e(w,m(p({},t),{title:"[X]",type:"x-square"})),oe=t=>e(w,m(p({},t),{title:"\u2753",type:"alert-circle"})),se=t=>e(w,m(p({},t),{color:"#b00000",title:"\u2B55",type:"circle"})),rt=t=>e(w,m(p({},t),{title:"Thermometer",type:"thermometer"})),mn=t=>e(w,m(p({},t),{title:"download",type:"download-cloud"})),at=t=>e(w,m(p({},t),{title:"\u{1F481}",type:"help-circle"})),gn=t=>e(w,m(p({},t),{title:"Rainy cloud",type:"cloud-rain"})),fn=t=>e(w,m(p({},t),{title:"\u{1F4E6}",type:"package"})),it=t=>e(w,m(p({},t),{title:"cellular",type:"bar-chart"})),ct=t=>e(w,m(p({},t),{title:"\u{1F50B}",type:"battery-charging"})),vn=t=>e(w,m(p({},t),{title:"\u{1F552}",type:"clock"})),bn=t=>e(w,m(p({},t),{title:"Neighboring Cells",type:"loader"})),yn=t=>e(w,m(p({},t),{title:"\u{1F5FA}\uFE0F",type:"map"})),Sn=t=>e(w,m(p({},t),{color:"#b46c10",title:"Outdated data",type:"frown"})),lt=t=>e(w,m(p({},t),{title:"\u2139\uFE0F",type:"info"})),Nn=t=>e(w,m(p({},t),{title:"Log out",type:"log-out"})),wn=t=>e(w,m(p({},t),{title:"Smartphone",type:"smartphone"})),xn=t=>e(w,m(p({},t),{title:"Bell",type:"bell"})),re=t=>e(w,m(p({},t),{title:"\u2304",type:"chevron-down"})),In=t=>e(w,m(p({},t),{title:"show",type:"eye"})),Cn=t=>e(w,m(p({},t),{title:"hide",type:"eye-off"})),x=({children:t})=>e("span",{className:nt.iconWithText,children:t}),_=({key:t,defaultValue:n,freezer:o})=>{const s=()=>localStorage.removeItem(t);return{set:r=>{var i;r===void 0&&s(),localStorage.setItem(t,((i=o==null?void 0:o.freeze)!=null?i:JSON.stringify)(r))},get:()=>{var i;const r=localStorage.getItem(t);if(r===null)return n;try{return((i=o==null?void 0:o.unfreeze)!=null?i:JSON.parse)(r)}catch{return console.error(`[withLocalStorage] Failed to load stored entry for ${t} from ${r}!`),n}},destroy:s}},dt={freeze:t=>t.toISOString(),unfreeze:t=>new Date(t)},V=_({key:"auth:isAuthenticated",defaultValue:!1}),X=_({key:"auth:jwt"});var xt;const we={isAuthenticated:(xt=V.get())!=null?xt:!1,jwtKey:X.get(),logout:async()=>Promise.resolve(),login:async()=>Promise.resolve()},ht=h.exports.createContext(we),ae=()=>h.exports.useContext(ht);class An extends Error{constructor(n,o){super(n);pe(this,"httpStatusCode");this.name="AuthError",this.httpStatusCode=o}}const Dn=({children:t,apiEndpoint:n})=>{const[o,s]=h.exports.useState(V.get()),[r,i]=h.exports.useState(X.get()),c={jwtKey:r,isAuthenticated:o,logout:async()=>{s(!1),V.destroy(),X.destroy();const l=new URL(document.location.href);document.location.href=new URL("/asset-tracker-cloud-app-golioth/",`${l.protocol}//${l.host}${l.pathname}`).toString()},login:async({id:l,secret:d})=>qe({endpoint:n,jwtKey:{id:l,secret:d}}).projects().then(()=>{s(!0),V.set(!0),X.set({id:l,secret:d}),i({id:l,secret:d})}).catch(u=>{throw console.error(u),s(!1),V.set(!1),X.destroy(),new An("Failed to log-in!",u.httpStatusCode)})};return e(ht.Provider,{value:c,children:t})};var Tn="/asset-tracker-cloud-app-golioth/logo.svg";const kn=Be(),jn=()=>{const{isAuthenticated:t,logout:n}=ae(),{device:o}=z();return e("header",{children:e("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",style:{background:"linear-gradient(79.13deg,#2fe077,#61d2c9 48.78%,#6a70db)"},children:a("div",{className:"container-fluid",children:[a(B,{className:"navbar-brand",to:"/",children:[e("img",{src:Tn,alt:"",width:"30",height:"24",className:"d-inline-block align-text-top me-1"}),o&&e("span",{children:o.name}),!o&&a("span",{children:["nRF Asset Tracker ",e("small",{children:"(Golioth)"})]})]}),e("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation",children:e("span",{className:"navbar-toggler-icon"})}),a("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo02",children:[a("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[t&&a(I,{children:[e("li",{className:"nav-item",children:a(B,{className:"nav-link",to:"/assets",children:[e(fn,{})," Assets"]})}),e("li",{className:"nav-item",children:e(B,{className:"nav-link",to:"/map",children:a(x,{children:[e(yn,{})," Map"]})})})]}),e("li",{className:"nav-item",children:e(B,{className:"nav-link",to:"/about",children:a(x,{children:[e(lt,{})," About"]})})}),e("li",{className:"nav-item",children:e("button",{type:"button",className:"btn btn-link nav-link",style:{fontWeight:"var(--bs-body-font-weight)"},onClick:()=>{kn.start()},children:a(x,{children:[e(at,{})," Help"]})})})]}),t&&e("form",{className:"d-flex",children:e("button",{type:"button",className:"btn btn-outline-light",onClick:n,children:a(x,{children:[e(Nn,{}),"Log out"]})})})]})]})})})},xe=ge(new Date,{months:1}),Ie=_({key:"chart:startDate",defaultValue:xe,freezer:dt}),Ce=new Date,Ae=_({key:"chart:endDate",defaultValue:Ce,freezer:dt}),ut=h.exports.createContext({startDate:Ie.get(),endDate:Ae.get(),setStartDate:()=>{},setEndDate:()=>{},defaultStart:xe,defaultEnd:Ce}),R=()=>h.exports.useContext(ut),En=({children:t})=>{const[n,o]=h.exports.useState(Ie.get()),[s,r]=h.exports.useState(Ae.get());return e(ut.Provider,{value:{startDate:n,endDate:s,setStartDate:i=>{i.getTime()>s.getTime()||(o(i),Ie.set(i))},setEndDate:i=>{i.getTime()<n.getTime()||(r(i),Ae.set(i))},defaultStart:xe,defaultEnd:Ce},children:t})},Fn=({version:t,homepage:n})=>e("main",{className:"container",children:e("div",{className:"row justify-content-center",children:a("div",{className:"col-md-10 col-lg-8 col-xl-6",children:[a("div",{className:"card","data-intro":"Did you know that this application is open source? Check out the links!",children:[e("div",{className:"card-header",children:"About"}),a("div",{className:"card-body",children:[a("p",{children:["This is the web application of the ",e("em",{children:"nRF Asset Tracker"})," ","which aims to provide a concrete end-to-end sample for an IoT product in the asset tracker space. You can find the source code on"," ",e("a",{href:n.toString(),target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),"."]}),a("p",{children:["Please also consider the"," ",e("a",{href:"https://nordicsemiconductor.github.io/asset-tracker-cloud-docs/",target:"_blank",rel:"noopener noreferrer",children:"nRF Asset Tracker"})," ","documentation."]})]})]}),a("div",{className:"card mt-4","data-intro":"This card shows the environment variables configure during build time of the application.",children:[e("div",{className:"card-header",children:"Environment"}),e("div",{className:"card-body",children:a("dl",{children:[e("dt",{children:"Version"}),e("dd",{children:e("code",{children:t})}),Object.entries({PUBLIC_VERSION:"9e03bf599513a5d0e8382b3206d7edcc61c50938",PUBLIC_HOMEPAGE:"https://github.com/NordicSemiconductor/asset-tracker-cloud-app-golioth-js#readme",BASE_URL:"/asset-tracker-cloud-app-golioth/",MODE:"production",DEV:!1,PROD:!0}).map(([o,s])=>a(He.Fragment,{children:[e("dt",{children:o}),e("dd",{children:e("code",{children:s===void 0?"N/A":typeof s=="string"?s:JSON.stringify(s)})})]},o))]})})]})]})})}),$n=120,De=t=>{var n,o,s,r,i,c,l,d,u,g,N,y;return(((s=(o=(n=t==null?void 0:t.reported)==null?void 0:n.cfg)==null?void 0:o.act)!=null?s:!0)?(c=(i=(r=t==null?void 0:t.reported)==null?void 0:r.cfg)==null?void 0:i.actwt)!=null?c:$n:(u=(d=(l=t==null?void 0:t.reported)==null?void 0:l.cfg)==null?void 0:d.mvt)!=null?u:3600)+((y=(N=(g=t==null?void 0:t.reported)==null?void 0:g.cfg)==null?void 0:N.gnsst)!=null?y:60)+60},Pn="_assetInformation_r2jnr_1";var Te={assetInformation:Pn};const T=({children:t})=>e("div",{style:{backgroundColor:"#eee",borderRadius:"5px",display:"flex",height:"50px",justifyContent:"space-around",alignItems:"center"},children:a(x,{children:[e(st,{}),t!=null?t:"No data."]})}),Mn=({reportedAt:t,receivedAt:n,staleAfterSeconds:o})=>{const s=n===void 0?!1:(n.getTime()-t.getTime())/1e3>300,r=n===void 0?!1:O(n,{includeSeconds:!0,addSuffix:!0})!==O(t,{includeSeconds:!0,addSuffix:!0}),i=(Date.now()-t.getTime())/1e3>(o!=null?o:Number.MAX_SAFE_INTEGER);return{reportedTimeIsOutDated:s,relativeTimesHaveDiff:r,reportIsOld:i}},_n=({reportIsOld:t,staleAfterSeconds:n})=>t?e("abbr",{className:"ps-1",title:`The asset is expected to report updates roughly every ${n} seconds, but the data is older.`,children:e(hn,{})}):null,G=r=>{var i=r,{reportedAt:t,receivedAt:n,staleAfterSeconds:o}=i,s=Z(i,["reportedAt","receivedAt","staleAfterSeconds"]);const{reportedTimeIsOutDated:c,relativeTimesHaveDiff:l,reportIsOld:d}=Mn({reportedAt:t,receivedAt:n,staleAfterSeconds:o});return a("span",m(p({className:"reportedTime"},s),{children:[a(x,{children:[d?e(Sn,{}):e(vn,{}),e(ne,{ts:t},t.toISOString()),o!==void 0&&e(_n,{reportIsOld:d,staleAfterSeconds:o})]}),n!==void 0&&c&&l&&e("span",{className:"ms-2",children:a(x,{children:[e(ot,{}),e(ne,{ts:n},n.toISOString())]})})]}))},pt=({asset:t})=>{const[n,o]=h.exports.useState({}),s=H();return h.exports.useEffect(()=>{s.project({id:t.projectId}).device({id:t.id}).multiHistory({sensors:["bat","env","roam","gnss","dev"]}).then(o).catch(console.error)},[t,s]),n},Rn=({device:t,state:n})=>{var i;const{roam:o,dev:s}=pt({asset:t}),r=De(n);return s===void 0?e(T,{}):a("div",{className:Te.assetInformation,children:[e("h4",{children:"Golioth"}),a("dl",{children:[e("dt",{children:"Asset ID"}),e("dd",{children:e("code",{children:t.id})}),e("dt",{children:"Project ID"}),e("dd",{children:e("code",{children:t.projectId})})]}),e("h4",{children:"Hard- and Software"}),a("dl",{children:[e("dt",{children:"Board"}),e("dd",{children:e("code",{children:s.v.brdV})}),e("dt",{children:"Modem"}),e("dd",{children:e("code",{children:s.v.modV})}),e("dt",{children:"Application"}),e("dd",{children:e("abbr",{title:"Golioth currently does not report the running firmware",children:e("code",{children:"\u2014"})})}),e("dt",{children:"IMEI"}),e("dd",{children:e("code",{children:s.v.imei})})]}),e("h4",{children:"Connection"}),a("dl",{children:[e("dt",{children:"ICCID"}),e("dd",{children:e("code",{children:s.v.iccid})}),o&&a(I,{children:[e("dt",{children:"Band"}),e("dd",{children:e("code",{children:o.v.band})}),e("dt",{children:"RSRP"}),e("dd",{children:e("code",{children:o.v.rsrp})}),e("dt",{children:"MCC/MNC"}),e("dd",{children:e("code",{children:o.v.mccmnc})}),e("dt",{children:"Area Code"}),e("dd",{children:e("code",{children:o.v.area})}),e("dt",{children:"CellID"}),e("dd",{children:e("code",{children:o.v.cell})}),e("dt",{children:"IP"}),e("dd",{children:e("code",{children:o.v.ip})})]})]}),e(G,{reportedAt:(i=o==null?void 0:o.ts)!=null?i:s.ts,staleAfterSeconds:r})]})},L=()=>{const{startDate:t,endDate:n,setStartDate:o,setEndDate:s,defaultStart:r,defaultEnd:i}=R();return e("form",{className:"mt-2 me-2 mb-2 ms-2",children:a("fieldset",{className:"row",children:[e("div",{className:"col-6",children:a("div",{className:"row",children:[e("div",{className:"col-sm-5",children:e("label",{htmlFor:"inclusiveStartDate",className:"col-form-label col-form-label-sm",children:"Start date"})}),e("div",{className:"col-sm-7",children:e("input",{type:"date",id:"inclusiveStartDate",className:"form-control form-control-sm",value:t.toISOString().substring(0,10),onChange:({target:{value:c}})=>{try{o(c===""?r:new Date(`${c}T00:00:00.000Z`))}catch{}}})})]})}),e("div",{className:"col-6",children:a("div",{className:"row",children:[e("div",{className:"col-sm-5",children:e("label",{htmlFor:"inclusiveEndDate",className:"col-form-label col-form-label-sm",children:"End date"})}),e("div",{className:"col-sm-7",children:e("input",{type:"date",id:"inclusiveEndDate",className:"form-control form-control-sm",value:n.toISOString().substring(0,10),onChange:({target:{value:c}})=>{try{s(c===""?i:new Date(`${c}T23:59:59.999Z`))}catch{}}})})]})})]})})},ke=({data:t,type:n,min:o,max:s})=>{const r=h.exports.useRef(jt());return h.exports.useLayoutEffect(()=>{const i=Et.new(r.current),c=i.container.children.push(Ft.new(i,{})),l=c.xAxes.push($t.new(i,{baseInterval:{timeUnit:"second",count:1},renderer:Pt.new(i,{})})),d=c.yAxes.push(Mt.new(i,{min:o,max:s,renderer:_t.new(i,{})})),u=Rt.new(i,{labelText:"{valueY}"}),g=c.series.push(n==="column"?Lt.new(i,{xAxis:l,yAxis:d,valueYField:"value",valueXField:"date",tooltip:u}):Ot.new(i,{xAxis:l,yAxis:d,valueYField:"value",valueXField:"date",tooltip:u}));return g.data.setAll(t.map(({date:N,value:y})=>({value:y,date:N.getTime()}))),c.set("cursor",Bt.new(i,{snapToSeries:[g],xAxis:l})),()=>{i.dispose()}},[t,n,o,s,r]),e("div",{style:{width:"100%",height:"300px"},id:r.current})},Ln=({asset:t})=>{const{startDate:n,endDate:o}=R(),r=K({sensor:$.Battery,startDate:n,endDate:o}).map(({v:i,ts:c})=>({date:new Date(c),value:i/1e3}));return a(I,{children:[e(L,{}),r.length===0?e(T,{}):e(ke,{data:r,type:"line"})]})},On=t=>{switch(t){case 1:return e("span",{children:"1\uFE0F\u20E3"});case 2:return e("span",{children:"2\uFE0F\u20E3"});case 3:return e("span",{children:"3\uFE0F\u20E3"});case 4:return e("span",{children:"4\uFE0F\u20E3"});default:return e("span",{children:t})}},Bn=({asset:t})=>{const{startDate:n,endDate:o}=R(),s=K({sensor:$.Button,startDate:n,endDate:o});return s.length===0?a(I,{children:[e(L,{}),e(T,{})]}):a(I,{children:[e(L,{}),a("table",{className:"table",children:[e("thead",{children:a("tr",{children:[e("th",{children:"Button"}),e("th",{children:"Time"})]})}),e("tbody",{children:s.map(({v:r,ts:i},c)=>a("tr",{children:[e("td",{children:On(r)}),a("td",{children:[i.toLocaleString()," ",a("small",{children:["(",e(ne,{ts:i}),")"]})]})]},c))})]})]})},mt=({dbm:t})=>e(ze.RSRP,{dbm:t,renderBar:({quality:n,dbm:o})=>a(I,{children:[e(ze.SignalQualityTriangle,{style:{width:"20px",height:"20px",marginRight:"0.2rem"},quality:n}),e("small",{children:`(${o} dBm)`})]}),renderInvalid:()=>e("abbr",{title:`Unexpected value ${t} reported!`,children:e(pn,{})})}),Hn=({icon:t,children:n})=>a("span",{children:[t,n]}),zn=({op:t})=>{var n;return e("span",{className:"operator",children:(n=t==null?void 0:t.brand)!=null?n:"Unknown"})},Gn=({networkMode:t,rsrp:n,mccmnc:o,reportedAt:s,iccid:r,dataStaleAfterSeconds:i})=>{const c=r!==void 0?Ht(r):void 0;return a(I,{children:[a("span",{children:[e(Hn,{icon:mt({dbm:n}),children:a(I,{children:["\xA0",e(zn,{op:zt.filter({mccmnc:`${o}`})[0]})]})}),e("abbr",{title:"Network mode",children:a(x,{children:[e(it,{size:16}),t!=null?t:"?"]})}),e("abbr",{title:"SIM issuer",children:a(x,{children:[e(wn,{size:16}),c!==void 0?c.companyName:"?"]})})]}),e(G,{reportedAt:s,staleAfterSeconds:i})]})},Wn="_assetInfoToggle_rgdue_1",Jn="_info_rgdue_1";var P={assetInfoToggle:Wn,info:Jn};const ie=({children:t,className:n})=>{const[o,s]=h.exports.useState(!1),r=()=>{s(!o)},i=l=>{l.code==="Enter"&&(l.stopPropagation(),l.preventDefault(),r())},c=l=>{l.stopPropagation(),l.preventDefault(),r()};return e("div",{className:`${n} toggle`,onClick:c,role:"button",tabIndex:0,onKeyDown:i,"data-toggled":o?"1":"0",children:t})},Un=({roam:t,dev:n,expectedSendIntervalInSeconds:o})=>t===void 0?null:e(ie,{className:P.assetInfoToggle,children:e("div",{className:P.info,children:e(Gn,{mccmnc:t.v.mccmnc,rsrp:t.v.rsrp,reportedAt:new Date(t.ts),networkMode:t==null?void 0:t.v.nw,iccid:n==null?void 0:n.v.iccid,dataStaleAfterSeconds:o})})}),Kn=({bat:t,expectedSendIntervalInSeconds:n})=>t===void 0?null:e(ie,{className:P.assetInfoToggle,children:a("div",{className:P.info,children:[a(x,{children:[e(ct,{}),t.v/1e3," V"]}),e(G,{reportedAt:new Date(t.ts),staleAfterSeconds:n})]})}),Vn=({gnss:t,expectedSendIntervalInSeconds:n})=>{var o,s;return((o=t==null?void 0:t.v)==null?void 0:o.spd)===void 0&&((s=t==null?void 0:t.v)==null?void 0:s.alt)===void 0?null:e(ie,{className:P.assetInfoToggle,children:a("div",{className:P.info,children:[a("span",{children:[t.v.spd!==void 0&&a(x,{children:[e(dn,{}),Math.round(t.v.spd)," m/s"]}),t.v.alt!==void 0&&a(x,{children:[e(un,{}),Math.round(t.v.alt)," m"]})]}),e(G,{reportedAt:new Date(t.ts),staleAfterSeconds:n})]})})},Xn=({env:t,expectedSendIntervalInSeconds:n})=>t===void 0?null:e(ie,{className:P.assetInfoToggle,children:a("div",{className:P.info,children:[a("span",{children:[t.v.temp&&a(x,{children:[e(rt,{}),t.v.temp,"\xB0C"]}),t.v.hum&&a(x,{children:[e(gn,{}),Math.round(t.v.hum),"%"]}),t.v.atmp&&a(x,{children:[e(ot,{}),Math.round(t.v.atmp*10)," hPa"]})]}),e(G,{reportedAt:new Date(t.ts),staleAfterSeconds:n})]})}),qn=({asset:t,state:n})=>{const{bat:o,env:s,roam:r,gnss:i,dev:c}=pt({asset:t}),l=De(n);return a(I,{children:[e(Un,{roam:r,expectedSendIntervalInSeconds:l,dev:c}),e(Vn,{gnss:i,expectedSendIntervalInSeconds:l}),e(Kn,{bat:o,expectedSendIntervalInSeconds:l}),e(Xn,{env:s,expectedSendIntervalInSeconds:l})]})},Yn=({asset:t,state:n})=>{var u,g,N,y,b;const{startDate:o,endDate:s}=R(),r=De(n),i=H(),[c,l]=h.exports.useState();if(h.exports.useEffect(()=>{let f=!0;return i.project({id:t.projectId}).device({id:t.id}).history({path:["ncellmeas"],limit:1,startDate:o,endDate:s}).then(S=>{!f||l(S[0])}).catch(console.error),()=>{f=!1}},[t,o,s,i]),c===void 0)return a(I,{children:[e(L,{}),e(T,{})]});const d=c.v;return a("div",{className:Te.assetInformation,children:[((g=(u=d.nmr)==null?void 0:u.length)!=null?g:0)===0&&e(T,{children:"No neighboring cells found."}),((y=(N=d.nmr)==null?void 0:N.length)!=null?y:0)>0&&e("ol",{children:(b=d.nmr)==null?void 0:b.map((f,S)=>e("li",{children:a("dl",{className:Te.AssetInformation,children:[e("dt",{children:"RSRP"}),e("dd",{children:e("code",{children:f.rsrp})}),e("dt",{children:"RSRQ"}),e("dd",{children:e("code",{children:f.rsrq})}),e("dt",{children:"CellID"}),e("dd",{children:e("code",{children:f.cell})}),e("dt",{children:"EARFCN"}),e("dd",{children:e("code",{children:f.earfcn})})]})},S))}),e(G,{reportedAt:c.ts,staleAfterSeconds:r})]})},Qn=({asset:t})=>{var r;const[n,o]=h.exports.useState((r=t.name)!=null?r:""),{updateDeviceSettings:s}=z();return a("form",{className:"justify-content-center","data-intro":"Use this form to give your asset a recognizable name.",children:[e("label",{htmlFor:"name",children:"Customize the name of your asset"}),a("div",{className:"d-flex flex-row",children:[e("input",{className:"form-control",type:"text",name:"name",id:"name",placeholder:"e.g. 'My Thingy:91'",onChange:({target:{value:i}})=>{o(i)},value:n}),e("button",{type:"button",className:"btn btn-primary ms-3",disabled:n===t.name,onClick:()=>{s({name:n}).catch(console.error)},children:"Update"})]})]})},Zn=({asset:t})=>{const{startDate:n,endDate:o}=R(),r=K({sensor:$.Roaming,startDate:n,endDate:o}).map(({v:i,ts:c})=>({date:new Date(c),value:i.rsrp}));return a(I,{children:[e(L,{}),r.length===0?e(T,{}):e(ke,{data:r,type:"line"})]})},eo=({asset:t})=>{const{startDate:n,endDate:o}=R(),r=K({sensor:$.Environment,startDate:n,endDate:o}).map(({v:i,ts:c})=>({date:new Date(c),value:i.temp}));return a(I,{children:[e(L,{}),r.length===0?e(T,{}):e(ke,{data:r,type:"line"})]})},to="_collapsable_kan6w_1",no="_spin_kan6w_1",oo="_chevron_kan6w_10";var ce={collapsable:to,spin:no,chevron:oo};const so=t=>{const n=_({key:t,defaultValue:!0}),[o,s]=h.exports.useState(n.get());return{collapsed:o,toggle:()=>{s(i=>{const c=!i;return n.set(c),c})}}},M=({id:t,title:n,children:o})=>{const{collapsed:s,toggle:r}=so(t),i=l=>{l.code==="Enter"&&(l.stopPropagation(),l.preventDefault(),r())},c=l=>{l.stopPropagation(),l.preventDefault(),r()};return s?e("section",{className:ce.collapsable,id:t,children:a("header",{onClick:c,role:"button",tabIndex:0,onKeyDown:i,"aria-expanded":"false",children:[e("div",{children:n}),e(re,{className:ce.chevron})]})}):a("section",{className:ce.collapsable,children:[a("header",{onClick:c,role:"button",tabIndex:0,onKeyDown:i,"aria-expanded":"true",children:[e("div",{children:n}),e(re,{className:ce.chevron})]}),e("div",{children:o})]})},ro=({onZoomEnd:t})=>{const n=Gt({zoomend:o=>t({event:o,map:n})});return null},ao="_mapContainer_jgd0w_1",io="_historyInfo_jgd0w_5";var je={mapContainer:ao,historyInfo:io};const co=()=>e("div",{style:{backgroundColor:"#ccc",display:"flex",height:"250px",justifyContent:"space-around",alignItems:"center"},children:a(x,{children:[e(st,{}),"No position known."]})}),gt=(t=!1)=>n=>({location:{position:{lat:n.v.lat,lng:n.v.lng,accuracy:n.v.acc,altitude:n.v.alt,speed:n.v.spd,heading:n.v.hdg},batch:t,ts:new Date(n.ts)},roaming:void 0}),lo=({locations:t})=>{var r,i;let n;const o=t[0];o!==void 0&&(n=gt(!1)(o).location);const s=n==null?void 0:n.position;return{assetLocation:n,center:s,history:(i=(r=t.slice(1))==null?void 0:r.map(gt(!1)))!=null?i:[]}},ft={follow:!0,enabledLayers:{headings:!0,singlecellLocations:!0,multicellLocations:!0,history:!0},zoom:13},vt=_({key:"map:settings",defaultValue:ft}),bt=h.exports.createContext({settings:ft,update:()=>{}}),yt=()=>h.exports.useContext(bt),ho=({children:t})=>{const[n,o]=h.exports.useState(vt.get());return e(bt.Provider,{value:{settings:n,update:s=>{o(r=>{const i=p(p({},r),s);return ve(i,r)?r:(vt.set(i),i)})}},children:t})},Ee=t=>t==null,Fe=t=>t.toFixed(2).replace(/(\.00)|(0)$/,""),St=({heading:t,position:n,mapZoom:o,color:s})=>e(Wt,{children:r=>{const{x:i,y:c}=r.project(n,o),l=r.unproject([i+o*3*Math.cos((t-90)%360*Math.PI/180),c+o*3*Math.sin((t-90)%360*Math.PI/180)],o);return e(Ge,{positions:[n,l],weight:o>16?1:2,lineCap:"round",color:s!=null?s:"#000000"})}},o),uo=({asset:t})=>{var N;const{settings:n,update:o}=yt(),{startDate:s,endDate:r}=R(),i=K({sensor:$.GNSS,limit:n.enabledLayers.history?void 0:1,startDate:s,endDate:r}),{assetLocation:c,center:l,history:d}=lo({locations:i}),[u,g]=h.exports.useState();return c===void 0||l===void 0?e(co,{}):(u&&n.follow&&u.flyTo(l,n.zoom),a(Re,{center:[l.lat,l.lng],zoom:n.zoom,whenCreated:g,className:je.mapContainer,children:[e(ro,{onZoomEnd:({map:y})=>{o({zoom:y.getZoom()})}}),e(Le,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e(Oe,{position:l,icon:Ke,children:e(fe,{children:t.name})}),(c==null?void 0:c.position.accuracy)!==void 0&&e(ee,{center:c.position,radius:c.position.accuracy}),n.enabledLayers.headings&&(c==null?void 0:c.position.heading)!==void 0&&e(St,{position:c.position,heading:c.position.heading,mapZoom:n.zoom}),((N=d==null?void 0:d.length)!=null?N:0)>0&&(d==null?void 0:d.map(({location:{position:{lat:y,lng:b,accuracy:f,heading:S,speed:v},batch:C,ts:D},roaming:k},Y)=>{const Pe=`#1f56d2${Math.round((1-Y/d.length)*255).toString(16)}`;return a(He.Fragment,{children:[e(ee,{center:{lat:y,lng:b},radius:1,color:Pe}),Y>0&&e(Ge,{positions:[d[Y-1].location.position,{lat:y,lng:b}],weight:n.zoom>16?1:2,lineCap:"round",color:Pe,dashArray:"10"}),S!==void 0&&n.enabledLayers.headings&&e(St,{position:{lat:y,lng:b},heading:S,mapZoom:n.zoom,color:"#00000080"}),C&&e(ee,{center:{lat:y,lng:b},radius:20,stroke:!0,color:"#ff0000",weight:2,fill:!1,dashArray:n.zoom>16?"3 6":"6 12"}),e(ee,{center:{lat:y,lng:b},radius:16,fillColor:"#826717",stroke:!1,children:a(fe,{position:{lat:y,lng:b},children:[a("div",{className:je.historyInfo,children:[!Ee(f)&&a(I,{children:[e("dt",{children:"Accuracy"}),a("dd",{children:[Fe(f)," m"]})]}),!Ee(v)&&a(I,{children:[e("dt",{children:"Speed"}),a("dd",{children:[Fe(v)," m/s"]})]}),!Ee(S)&&a(I,{children:[e("dt",{children:"Heading"}),a("dd",{children:[Fe(S),"\xB0"]})]}),e("dt",{children:"Time"}),e("dd",{children:e("time",{dateTime:new Date(D).toISOString(),children:O(D,{includeSeconds:!0,addSuffix:!0})})}),C&&a(I,{children:[e("dt",{children:"Batch"}),e("dd",{children:"Yes"})]})]}),k!==void 0&&!C&&e(I,{children:a("div",{className:je.historyInfo,children:[e("dt",{children:"Connection"}),e("dd",{style:{textAlign:"right"},children:e(mt,{dbm:k.roaming.rsrp})}),e("dt",{children:"MCC/MNC"}),e("dd",{children:k.roaming.mccmnc}),e("dt",{children:"Area Code"}),e("dd",{children:k.roaming.area}),e("dt",{children:"Cell ID"}),e("dd",{children:k.roaming.cell}),e("dt",{children:"IP"}),e("dd",{children:k.roaming.ip}),e("dt",{children:"RSRP"}),e("dd",{children:k.roaming.rsrp}),e("dt",{children:"Time"}),e("dd",{children:e("time",{dateTime:new Date(k.ts).toISOString(),children:O(k.ts,{includeSeconds:!0,addSuffix:!0})})})]})})]})})]},`history-${Y}`)}))]}))},po=()=>{const{settings:t,update:n}=yt(),o=s=>{const r=m(p({},t),{enabledLayers:p(p({},t.enabledLayers),s)});n(r)};return a(I,{children:[a("form",{className:"pt-2 pe-2 ps-2",children:[a("div",{className:"row ps-1 pe-1",children:[e("div",{className:"col-lg-6 pt-1 pb-1",children:a("div",{className:"form-check form-switch",children:[e("input",{className:"form-check-input",type:"checkbox",name:"follow",onChange:()=>{const s=m(p({},t),{follow:!t.follow});n(s)},checked:t.follow,id:"mapSettingsFollow"}),e("label",{htmlFor:"mapSettingsFollow",children:"Re-center on position"})]})}),e("div",{className:"col-lg-6 pt-1 pb-1",children:a("div",{className:"form-check form-switch",children:[e("input",{className:"form-check-input",type:"checkbox",name:"headings",onChange:()=>{o({headings:!t.enabledLayers.headings})},checked:t.enabledLayers.headings,id:"mapSettingsHeadings"}),e("label",{htmlFor:"mapSettingsHeadings",children:"Headingmarker"})]})})]}),a("div",{className:"row ps-1 pe-1",children:[e("div",{className:"col-lg-6 pt-1 pb-1",children:a("div",{className:"form-check form-switch",children:[e("input",{className:"form-check-input",type:"checkbox",name:"singlecellLocation",onChange:()=>{o({singlecellLocations:!t.enabledLayers.singlecellLocations})},checked:t.enabledLayers.singlecellLocations,id:"mapSettingsSingleCellLocations"}),e("label",{htmlFor:"mapSettingsSingleCellLocations",children:"Singlecell locations"})]})}),e("div",{className:"col-lg-6 d-flex",children:a("div",{className:"form-check form-switch flex-grow-1",children:[e("input",{className:"form-check-input",type:"checkbox",name:"fetchHistoricalData",onChange:()=>{o({history:!t.enabledLayers.history})},checked:t.enabledLayers.history,id:"fetchHistory"}),e("label",{htmlFor:"fetchHistory",className:"text-nowrap",children:"Fetch history"})]})})]}),e("div",{className:"row ps-1 pe-1",children:e("div",{className:"col-lg-6 pt-1 pb-1",children:a("div",{className:"form-check form-switch",children:[e("input",{className:"form-check-input",type:"checkbox",name:"multicellLocation",onChange:()=>{o({multicellLocations:!t.enabledLayers.multicellLocations})},checked:t.enabledLayers.multicellLocations,id:"mapSettingsMultiCellLocations"}),e("label",{htmlFor:"mapSettingsMultiCellLocations",children:"Multicell locations"})]})})})]}),e(L,{})]})},mo="_showSettingsButton_g7xrc_1",go="_chevron_g7xrc_28";var le={showSettingsButton:mo,chevron:go};const fo=({onToggle:t})=>{const[n,o]=h.exports.useState(!0),s=()=>{const r=!n;o(r),t==null||t(r)};return n?a("button",{type:"button",title:"Expand",onClick:s,"aria-expanded":"false",className:le.showSettingsButton,children:[e(Ne,{}),e(re,{className:le.chevron})]}):a("button",{type:"button",color:"link",title:"Collapse",onClick:s,"aria-expanded":"true",className:le.showSettingsButton,children:[e(Ne,{}),e(re,{className:le.chevron})]})},vo=({asset:t})=>{const[n,o]=h.exports.useState(!1);return a(ho,{children:[a("div",{style:{position:"relative"},children:[e(uo,{asset:t}),e(fo,{onToggle:s=>o(!s)})]}),n&&e(po,{})]})},bo=Be(),Nt=_({key:"settings:helpNoteHidden",defaultValue:!1}),yo=()=>{const[t,n]=h.exports.useState(Nt.get());return t?null:a("div",{className:"alert alert-info mt-4 d-flex justify-content-between align-items-center",role:"alert",children:[a("span",{children:["Click",e("button",{type:"button",className:"btn btn-link",onClick:()=>{window.requestAnimationFrame(()=>{bo.start()})},children:a(x,{children:[e(at,{}),"Help"]})}),"to view a detailed description of the settings."]}),e("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:()=>{Nt.set(!0),n(!0)}})]})},So={act:!1,actwt:60,mvres:300,mvt:3600,gnsst:60,acct:.1,nod:[]},de=({desired:t,reported:n,isEqual:o,onNotReported:s,onOutDated:r})=>t===void 0?null:n===void 0?e(I,{children:s}):(o!=null?o:ve)(t,n)?null:r(n),q=({label:t,intro:n,id:o,unit:s,example:r,step:i,onChange:c,desired:l,reported:d,minimum:u,maximum:g})=>{const[N,y]=h.exports.useState(`${l!=null?l:d}`),b=u!=null?u:0,f=g!=null?g:Number.MAX_SAFE_INTEGER;return a("div",{className:"input-group mb-2","data-intro":n,children:[t!==void 0&&a("label",{className:"form-label",htmlFor:o,children:[t,":"]}),a("div",{className:"input-group mb-2",children:[e(de,{desired:l,reported:d,onNotReported:e("span",{className:"input-group-text text-danger",children:e("abbr",{title:"Asset has not reported this setting, yet.",className:" d-flex justify-content-center align-items-center",children:e(oe,{})})}),onOutDated:S=>e("span",{className:"input-group-text d-flex justify-content-center align-items-center",children:e("abbr",{className:" d-flex justify-content-center align-items-center",title:`Asset has an outdated value. Current value: ${JSON.stringify(S)}.`,children:e(se,{})})})}),e("input",{className:"form-control",type:"number",name:o,id:o,placeholder:`e.g. "${r!=null?r:60}"`,step:i,min:b,max:f,value:N,onChange:({target:{value:S}})=>{parseInt(S)<b&&(S=`${b}`),parseInt(S)>f&&(S=`${f}`),y(S),c(S)}}),e("span",{className:"input-group-text",children:s!=null?s:"s"})]})]})},No="_SettingsForm_apo45_1",wo="_SideBySide_apo45_43",xo="_Help_apo45_56",Io="_FooterWithFullWidthButton_apo45_68";var $e={SettingsForm:No,SideBySide:wo,Help:xo,FooterWithFullWidthButton:Io};const he=2147483647,W=(t,n)=>Jt("btn",{[`btn-${t}`]:!n,[`btn-outline-${t}`]:n}),Co=()=>{const{state:t}=z(),[n,o]=h.exports.useState();return h.exports.useEffect(()=>{t!==void 0&&o(p(p({},So),t.desired.cfg))},[o,t]),n===void 0?e(T,{}):e(Ao,{currentDesiredConfig:n})},Ao=({currentDesiredConfig:t})=>{var g,N,y,b,f,S;const{updateAssetConfiguration:n,state:o}=z(),{reported:{cfg:s}}=o!=null?o:{reported:{cfg:{}}},[r,i]=h.exports.useState(t),c=!ve(r,t),l=v=>{const C=p(p({},r),v);i(C)},d=(v,C)=>D=>{l({[v]:C!==void 0?C(D):parseInt(D,10)})},u=r.act!==void 0?r.act===!0:(s==null?void 0:s.act)===!0;return a("form",{className:$e.SettingsForm,children:[a("fieldset",{"data-intro":"This sets the operation mode of the asset.",children:[e("legend",{children:"Mode"}),e("div",{className:"input-group mb-2",children:a("div",{className:"btn-group",role:"group",children:[e(de,{desired:r.act,reported:s==null?void 0:s.act,onNotReported:e("button",{type:"button",className:"btn btn-danger d-flex justify-content-center align-items-center",disabled:!0,title:"Asset has not reported this setting, yet.",children:e(oe,{})}),onOutDated:v=>e("button",{type:"button",className:"btn btn-outline-danger d-flex justify-content-center align-items-center",disabled:!0,title:`Asset has an outdated value. Current value: ${JSON.stringify(v)}.`,children:e(se,{})})}),e("button",{type:"button",className:W("info",u),"data-intro":"In <em>Passive</em> mode, the asset will wait for movement (triggered by the accelerometer) before sending an update to the cloud.",onClick:()=>{l({act:!1})},children:"Passive"}),e("button",{type:"button",className:W("success",!u),"data-intro":"In <em>Active</em> mode, the asset will send an update in a configurable interval.",onClick:()=>{l({act:!0})},children:"Active"})]})})]}),a("fieldset",{"data-intro":"How long to try to acquire a GNSS fix.",children:[e("legend",{children:"GNSS Timeout"}),e(q,{id:"gnsst",desired:r.gnsst,reported:s==null?void 0:s.gnsst,example:60,onChange:d("gnsst"),minimum:1,maximum:he})]}),a("fieldset",{"data-intro":"This configures the <em>passive</em> mode.",style:{gridRowEnd:"span 2"},children:[e("legend",{children:"Passive Mode Settings"}),a("div",{className:$e.SideBySide,children:[e(q,{label:"Movement Resolution",intro:"After detecting movement send an update and wait this amount of time until movement again can trigger the next update.",id:"mvres",desired:r.mvres,reported:s==null?void 0:s.mvres,onChange:d("mvres"),minimum:1,maximum:he,example:300}),e(q,{label:"Movement Timeout",intro:"Send updates to the cloud at least this often.",id:"mvt",example:3600,desired:r.mvt,reported:s==null?void 0:s.mvt,onChange:d("mvt"),minimum:1,maximum:he})]}),e(q,{label:"Accelerometer threshold",intro:"Minimal absolute value for an accelerometer reading to be considered movement. Range: 0 to 19.6133 m/s\xB2.",id:"acct",example:.1,step:.1,minimum:0,maximum:19.6133,unit:"m/s\xB2",desired:r.acct,reported:s==null?void 0:s.acct,onChange:d("acct",parseFloat)})]}),a("fieldset",{"data-intro":"This configures the <em>active</em> mode.",children:[e("legend",{children:"Active Mode Settings"}),e(q,{label:"Active Wait Time",intro:"Wait this amount of seconds until sending the next update. The actual interval will be this time plus the time it takes to get a GNSS fix.",id:"actwt",desired:r.actwt,reported:s==null?void 0:s.actwt,onChange:d("actwt"),minimum:1,maximum:he,example:60})]}),a("fieldset",{"data-intro":"This sets which Data Modules to sample.",children:[e("legend",{children:"Data Sampling"}),a("div",{className:"input-group mb-2",children:[e("label",{className:"form-label",htmlFor:"nod-gnss",children:"GNSS:"}),a("div",{className:"btn-group",role:"group",children:[e(de,{desired:r.nod,reported:s==null?void 0:s.nod,onNotReported:e("button",{type:"button",className:"btn btn-danger d-flex justify-content-center align-items-center",disabled:!0,title:"Asset has not reported this setting, yet.",id:"nod-gnss",children:e(oe,{})}),onOutDated:v=>e("button",{type:"button",className:"btn btn-outline-danger d-flex justify-content-center align-items-center",disabled:!0,title:`Asset has an outdated value. Current value: ${JSON.stringify(v)}.`,children:e(se,{})}),isEqual:(v,C)=>{const D=v.includes(A.GNSS);return C.includes(A.GNSS)===D}}),e("button",{type:"button",className:W("success",(N=(g=r.nod)==null?void 0:g.includes(A.GNSS))!=null?N:!1),"data-intro":"In <em>Enabled</em> mode, the asset will use GNSS to send location data to the cloud.",onClick:()=>{var v;l({nod:[...(v=r.nod)!=null?v:[]].filter(C=>C!==A.GNSS)})},children:"Enabled"}),e("button",{type:"button",className:W("danger",r.nod===void 0||!((y=r.nod)==null?void 0:y.includes(A.GNSS))),"data-intro":"In <em>Disabled</em> mode, the asset will not use GNSS to send location data to the cloud.",onClick:()=>{var v;l({nod:[...new Set([...(v=r.nod)!=null?v:[],A.GNSS])]})},children:"Disabled"})]})]}),a("div",{className:"input-group mb-2",children:[e("label",{className:"form-label",htmlFor:"nod-ncell",children:"Neighbor Cell Measurements:"}),a("div",{className:"btn-group",role:"group",children:[e(de,{desired:r.nod,reported:s==null?void 0:s.nod,onNotReported:e("button",{type:"button",className:"btn btn-danger d-flex justify-content-center align-items-center",disabled:!0,title:"Asset has not reported this setting, yet.",id:"nod-ncell",children:e(oe,{})}),onOutDated:v=>e("button",{type:"button",className:"btn btn-outline-danger d-flex justify-content-center align-items-center",disabled:!0,title:`Asset has an outdated value. Current value: ${JSON.stringify(v)}.`,children:e(se,{})}),isEqual:(v,C)=>{const D=v.includes(A.NeigboringCellMeasurements);return C.includes(A.NeigboringCellMeasurements)===D}}),e("button",{type:"button",className:W("success",(f=(b=r.nod)==null?void 0:b.includes(A.NeigboringCellMeasurements))!=null?f:!1),"data-intro":"In <em>Enabled</em> mode, the asset will use Neighbor Cell Measurements to send location data to the cloud.",onClick:()=>{var v;l({nod:[...(v=r.nod)!=null?v:[]].filter(C=>C!==A.NeigboringCellMeasurements)})},children:"Enabled"}),e("button",{type:"button",className:W("danger",r.nod===void 0||!((S=r.nod)==null?void 0:S.includes(A.NeigboringCellMeasurements))),"data-intro":"In <em>Disabled</em> mode, the asset will not use Neighbor Cell Measurements to send location data to the cloud.",onClick:()=>{var v;l({nod:[...new Set([...(v=r.nod)!=null?v:[],A.NeigboringCellMeasurements])]})},children:"Disabled"})]})]})]}),e("footer",{className:$e.FooterWithFullWidthButton,children:e("button",{type:"button",className:"btn btn-primary",disabled:!c,onClick:()=>{n(r).catch(console.error)},children:"Update"})})]})},Do=({device:t,state:n})=>e("main",{className:"container",children:e("div",{className:"row justify-content-center mb-4",children:e("div",{className:"col-md-10 col-lg-8 col-xl-6",children:a("div",{className:"card",children:[n&&a("div",{className:"card-header pt-0 pe-0 pb-0 ps-0",children:[e("div",{"data-intro":"This map shows the location of your asset.",children:e(vo,{asset:t})}),e("hr",{className:"mt-0 mb-0"}),e("div",{"data-intro":"This provides on overview of important asset information.",children:e(qn,{asset:t})})]}),a("div",{className:"card-body",children:[a(M,{title:a(x,{children:[e(Ne,{size:22}),"Settings"]}),id:"cat:settings",children:[e("h4",{children:"Personalization"}),e(Qn,{asset:t}),a("div",{"data-intro":"This allows you change the run-time configuration of the asset.",children:[e("h4",{className:"mt-4 ",children:"Asset configuration"}),e(yo,{}),e(Co,{})]})]}),e(M,{title:a(x,{children:[e(lt,{size:22}),"Asset Information"]}),id:"cat:information",children:e(Rn,{device:t,state:n})}),e(M,{title:a(x,{children:[e(mn,{size:22}),"Firmware Upgrade over-the-air (FOTA)"]}),id:"cat:fota",children:a("div",{className:"alert alert-info",role:"alert",children:["Manage the firmware of your asset through the"," ",e("a",{href:"https://console.golioth.io/",target:"_blank",rel:"nofollow noreferrer",children:"Golioth Console"}),"."]})}),e(M,{title:a(x,{children:[e(bn,{size:22}),"Neighboring cells"]}),id:"cat:ncell",children:e(Yn,{asset:t,state:n})}),e(M,{title:a(x,{children:[e(it,{size:22}),"RSRP"]}),id:"cat:rsrp",children:e(Zn,{asset:t})}),e(M,{title:a(x,{children:[e(ct,{size:22}),"Battery"]}),id:"cat:battery",children:e(Ln,{asset:t})}),e(M,{title:a(x,{children:[e(rt,{size:22}),"Temperature"]}),id:"cat:temperature",children:e(eo,{asset:t})}),e(M,{title:a(x,{children:[e(xn,{size:22}),"Button"]}),id:"cat:button",children:e(Bn,{asset:t})})]})]})})})}),To=()=>{const{assetId:t}=Ut(),{device:n,state:o,setDeviceId:s}=z();return h.exports.useEffect(()=>(s(t),()=>{s()}),[t,s]),n===void 0?e("main",{className:"container",children:e("div",{className:"row justify-content-center mb-4",children:e("div",{className:"col-md-10 col-lg-8 col-xl-6",children:e(T,{})})})}):e(Do,{device:n,state:o})},ko=()=>{const{devices:t}=U();return e("main",{className:"container",children:e("div",{className:"row justify-content-center",children:e("div",{className:"col-md-10 col-lg-8 col-xl-6",children:a("div",{className:"card","data-intro":"This card lists the assets in your project. Click on one to see its details.",children:[a("div",{className:"card-header d-flex align-items-center justify-content-between",children:[e("span",{className:"me-4",children:"Assets"}),e(Ze,{})]}),t.length===0&&e("div",{className:"card-body",children:e(T,{})}),t.length>0&&e("table",{className:"table",children:e("tbody",{children:t.map((n,o)=>e("tr",{children:e("td",{children:e(B,{to:`/project/${n.projectId}/asset/${n.id}`,"data-intro":o===0?"Click on a asset to view its details.":void 0,children:n.name})})},n.id))})})]})})})})},jo=()=>{const[t,n]=h.exports.useState(""),[o,s]=h.exports.useState(""),r=t.length>20&&o.length>20,{login:i}=ae(),[c,l]=h.exports.useState(!1),[d,u]=h.exports.useState(!1);return h.exports.useEffect(()=>{let g=!0;if(!!r&&!!c)return i({id:t,secret:o}).catch(console.error.bind("[Login]")).finally(()=>{g&&l(!1)}),()=>{g=!1}},[r,c,t,o,i]),e("main",{className:"container",children:e("div",{className:"row justify-content-center",children:e("div",{className:"col-md-10 col-lg-8 col-xl-6",children:e("div",{className:"card","data-intro":"The login credentials for this application are your Golioth JWT key and secret. You can acquire them from the Golioth Console. Make sure to select the type 'JWT Token'.",children:a("form",{children:[e("div",{className:"card-header",children:"Login"}),a("div",{className:"card-body",children:[a("div",{className:"mb-3","data-intro":"Enter your Golioth API JWT key identifier.",children:[e("label",{htmlFor:"jwtKey",className:"form-label",children:"JWT key"}),e("input",{type:"text",className:"form-control",id:"jwtKey","aria-describedby":"jwtKeyHelp",value:t,disabled:c,onChange:({target:{value:g}})=>n(g),autoComplete:"off"}),e("div",{id:"jwtKeyHelp",className:"form-text",children:"The identifier of your Golioth API JWT key."})]}),a("div",{className:"mb-3","data-intro":"Enter your Golioth API JWT key secret.",children:[e("label",{htmlFor:"jwtSecret",className:"form-label",children:"JWT secret"}),a("div",{className:"input-group",children:[e("input",{type:d?"text":"password",className:"form-control",id:"jwtSecret","aria-describedby":"jwtSecretHelp",value:o,disabled:c,onChange:({target:{value:g}})=>s(g),autoComplete:"off"}),d&&e("button",{className:"btn btn-outline-secondary",type:"button",title:"hide JWT secret",onClick:()=>{u(!1)},children:e(Cn,{})}),!d&&e("button",{className:"btn btn-outline-secondary",type:"button",title:"show JWT secret",onClick:()=>{u(!0)},children:e(In,{})})]}),e("div",{id:"jwtSecretHelp",className:"form-text",children:"The secret of your Golioth API JWT key."})]})]}),e("div",{className:"card-footer d-flex flex-row-reverse",children:e("button",{type:"button",className:"btn btn-primary",disabled:!r||c,onClick:()=>{l(!0)},"data-intro":"Finally, click this button to log in.",children:"Log in"})})]})})})})})},wt=new URL("https://api.golioth.io/v1/".replace(/\/$/,"")),Eo=()=>{var o,s;const t=(o=ae().isAuthenticated)!=null?o:we.isAuthenticated,n=(s=ae().jwtKey)!=null?s:we.jwtKey;return a(Vt,{basename:"/asset-tracker-cloud-app-golioth/",children:[e(jn,{}),!t&&a(be,{children:[e(j,{index:!0,element:e(ye,{to:"/login"})}),e(j,{path:"/login",element:e(jo,{})})]}),t&&n!==void 0&&e(en,{jwtKey:n,endpoint:wt,children:e(tn,{children:e(on,{children:e(En,{children:a(be,{children:[e(j,{path:"/login",element:e(ye,{to:"/assets"})}),e(j,{path:"/",element:e(ye,{to:"/assets"})}),e(j,{path:"/assets",element:e(ko,{})}),e(j,{path:"/map",element:e(rn,{})}),e(j,{path:"/project/:projectId/asset/:assetId",element:e(To,{})})]})})})})}),e(be,{children:e(j,{path:"/about",element:e(Fn,{version:"9e03bf599513a5d0e8382b3206d7edcc61c50938",homepage:new URL("https://github.com/NordicSemiconductor/asset-tracker-cloud-app-golioth-js#readme")})})})]})};Kt.exports.render(e(Dn,{apiEndpoint:wt,children:e(Eo,{})}),document.getElementById("root"));
